(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))m(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&m(f)}).observe(document,{childList:!0,subtree:!0});function c(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function m(o){if(o.ep)return;o.ep=!0;const d=c(o);fetch(o.href,d)}})();const T=Object.freeze([["pyramid","drink","worm"],["pyramid","kill","worm"],["pyramid","stop","savathun"],["pyramid","give","darkness"],["guardian","worship","light"],["guardian","worship","traveller"],["guardian","kill","witness"],["traveller","give","guardian"],["traveller","give","light"],["hive","worship","darkness"],["hive","worship","worm"],["darkness","stop","savathun"]]),V=Object.freeze([["hive","kill","worm"],["hive","kill","light"],["hive","give","darkness"],["hive","stop","witness"],["traveller","kill","guardian"],["traveller","drink","worm"],["traveller","give","hive"],["traveller","stop","witness"],["pyramid","drink","guardian"],["pyramid","stop","witness"],["witness","drink","light"],["witness","kill","pyramid"],["guardian","worship","witness"],["guardian","kill","traveller"],["savathun","drink","darkness"],["savathun","stop","darkness"],["light","stop","savathun"]]);let F=null,H=null;const ne=(s,i)=>s.length===i.length&&s.every((c,m)=>c===i[m]),be=s=>T.some(i=>ne(i,s))?"truth":V.some(i=>ne(i,s))?"lie":null,le=s=>[1,2,3].map(i=>document.querySelector(`.dial-slot.${s}${i}`)?.dataset.symbol||null),G=(s,i)=>s.filter(c=>c.every((m,o)=>!i[o]||i[o]===m)),ve=(s,i)=>{const c=new Set(s);return!i.some(m=>c.has(m))};function U(s){return F?F===s?H==="truth"?[T]:[V]:H==="truth"?[V]:[T]:[T,V]}function se(s,i){const c=[...new Set(U("left").flatMap(o=>G(o,s).map(d=>d.join("|"))))].map(o=>o.split("|")),m=[...new Set(U("right").flatMap(o=>G(o,i).map(d=>d.join("|"))))].map(o=>o.split("|"));if(!c.length||!m.length)return!1;for(const o of c)for(const d of m)if(ve(o,d))return!0;return!1}function Ee(s,i,c){if(c<0||c>2)return[];const m=i==="left"?[...s]:le("left"),o=i==="right"?[...s]:le("right"),d=G(U(i).flat(),i==="left"?m:o),f=[...new Set(d.map(w=>w[c]))],y=new Set(s.filter(Boolean)),g=[];for(const w of f)if(!y.has(w))if(i==="left"){const E=[...m];E[c]=w,se(E,o)&&g.push(w)}else{const E=[...o];E[c]=w,se(m,E)&&g.push(w)}return g}function q(s){return be(s)}function ie(s,i){F=s,H=i}function ae(){F=null,H=null}window.MAP_COORDS={stop:{top:"22.31%",left:"38.64%"},kill:{top:"70.14%",left:"65.96%"},darkness:{top:"39.91%",left:"80.93%"},drink:{top:"1.74%",left:"56.29%"},give:{top:"22.31%",left:"53.32%"},guardian:{top:"45.96%",left:"19.49%"},hive:{top:"29.77%",left:"19.53%"},light:{top:"59.68%",left:"72.98%"},pyramid:{top:"62.75%",left:"2.15%"},savathun:{top:"5.32%",left:"92.50%"},traveller:{top:"87.52%",left:"19.53%"},witness:{top:"30.20%",left:"2.00%"},worm:{top:"7.16%",left:"75.20%"},worship:{top:"70.42%",left:"31.45%"}};window.SYMBOL_NAME_MAP={stop:"STOP",kill:"KILL",darkness:"DARKNESS",drink:"DRINK",give:"GIVE",guardian:"GUARDIAN",hive:"HIVE",light:"LIGHT",pyramid:"PYRAMID",savathun:"SAVATHUN",traveller:"TRAVELLER",witness:"WITNESS",worm:"WORM",worship:"WORSHIP"};const $={defaultDesktop:"below",defaultMobile:"below",desktopAbove:["hive","drink","witness","pyramid","worm"],mobileAbove:["hive","drink","witness","pyramid","worm"]};function re(){return window.matchMedia("(max-width: 640px)").matches}function W(){const s=new Set(re()?$.mobileAbove:$.desktopAbove),i=(re()?$.defaultMobile:$.defaultDesktop)==="above";document.querySelectorAll(".symbol-wrap").forEach(c=>{const m=c.dataset.symbol,o=s.has(m)||i;c.classList.toggle("label-above",o),c.classList.toggle("label-below",!o)})}function Le(s=[],i=[]){const c=document.getElementById("map-overlay");if(!c)return;c.innerHTML="";const m=(o,d)=>{const f=symbolPositions[o];if(!f)return;const y=document.createElement("div");y.className=`symbol-wrap ${d}`,y.dataset.symbol=o,y.style.top=f.top,y.style.left=f.left;const g=document.createElement("img");g.className="symbol-overlay",g.src=`img/${o}.png`,g.alt=o,y.appendChild(g);const w=document.createElement("div");w.className="map-label",w.textContent=o.toUpperCase(),y.appendChild(w),c.appendChild(y)};s.forEach(o=>m(o,"truth")),i.forEach(o=>m(o,"lie")),W()}window.addEventListener("resize",W);window.addEventListener("orientationchange",W);window.showMapHighlights=Le;window.addEventListener("DOMContentLoaded",()=>{const s=()=>{const e=document.querySelector(".dial");if(!e)return;const t=e.getBoundingClientRect().width,n=parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--truthlie-coef"))||.085,l=Math.max(10,Math.round(t*n))+"px",a=document.getElementById("label-left"),r=document.getElementById("label-right");a&&a.style.setProperty("font-size",l,"important"),r&&r.style.setProperty("font-size",l,"important")};requestAnimationFrame(s),window.addEventListener("resize",s);const i=5;function c(e){if(!e)return{x:50,y:50};if("x"in e&&"y"in e)return{x:+e.x,y:+e.y};const t=parseFloat(e.left),n=parseFloat(e.top),l=i/2;return{x:t+l,y:n+l}}function m(){const e=document.querySelectorAll(".symbol-overlay");e.forEach(t=>t.classList.remove("pulse")),document.body.offsetWidth,e.forEach(t=>t.classList.add("pulse"))}const o=()=>requestAnimationFrame(()=>requestAnimationFrame(m)),d=document.querySelectorAll(".dial-slot"),f=document.getElementById("symbolPopup"),y=document.getElementById("popupGrid"),g=document.getElementById("lockButton"),w=document.querySelector(".btn-reset"),E=document.getElementById("tooltip"),D=document.getElementById("tooltipCheckbox"),C=document.getElementById("symbolNamesCheckbox");let k="entry",M=[],B=[],P=[];localStorage.getItem("firstVisitDone")!=="true"&&(localStorage.setItem("tooltipVisible","true"),localStorage.setItem("showSymbolNames","true"),localStorage.setItem("firstVisitDone","true"));const K=(localStorage.getItem("tooltipVisible")??"true")==="true";D.checked=K,E.classList.toggle("hidden",!K),D.addEventListener("change",()=>{const e=D.checked;E.classList.toggle("hidden",!e),localStorage.setItem("tooltipVisible",e?"true":"false")});const S=e=>{E&&(E.textContent=e)},Y=(localStorage.getItem("showSymbolNames")??"true")==="true";C.checked=Y;function N(e){document.querySelectorAll(".dial-slot .symbol-name, .map-label").forEach(t=>{t.style.display=e?"block":"none"})}N(Y),C.addEventListener("change",()=>{const e=C.checked;localStorage.setItem("showSymbolNames",e?"true":"false"),N(e)});const Z=e=>[1,2,3].map(t=>document.querySelector(`.dial-slot.${e}${t}`)),L=e=>Z(e).map(t=>t?.dataset.symbol||null),ce=()=>L("left").every(Boolean)&&L("right").every(Boolean);function de(e){const t=(e.dataset.symbol||"").toUpperCase();let n=e.querySelector(".symbol-name");n||(n=document.createElement("div"),n.className="symbol-name",e.appendChild(n)),n.textContent=t,n.style.display=C.checked?"block":"none"}const _=(e,t)=>{e.dataset.symbol=t||"",e.style.backgroundImage=t?`url('img/${t}.png')`:"",de(e)};function J(e,t,n){const l=[...new Set(Ee(e,t,n))],a=new Set(e.filter(Boolean));return l.filter(r=>!a.has(r))}function ue(e,t){const n=L(e);return n[t]=null,J(n,e,t)}function Q(e,t){const n=L(e);return J(n,e,t)}const X=()=>{if(k!=="entry")return;const e=L("left"),t=L("right"),n=e.every(Boolean),l=t.every(Boolean);if(n&&!l){const a=q(e);a&&(ie("left",a),ee("left",a),S("Now complete the opposite side."))}else if(l&&!n){const a=q(t);a&&(ie("right",a),ee("right",a),S("Now complete the opposite side."))}};function ee(e,t){const n=document.getElementById("label-left"),l=document.getElementById("label-right"),a=(r,h)=>{r&&(r.textContent=h?h.toUpperCase():"",r.className=h==="truth"?"truth-label":h==="lie"?"lie-label":"")};e==="left"?(a(n,t),l&&a(l,"")):(a(l,t),n&&a(n,"")),s()}const me=()=>{if(k!=="entry")return;let e=!0;for(;e;)e=!1,["left","right"].forEach(t=>{Z(t).forEach((n,l)=>{if(!n||n.dataset.symbol)return;const a=Q(t,l);a.length===1&&(_(n,a[0]),e=!0,X())})});z()},pe=window.MAP_COORDS||{},fe=window.SYMBOL_NAME_MAP||{};window.showMapHighlights=(e,t,n=!0)=>{const l=document.getElementById("map-overlay");if(!l)return;l.innerHTML="",[...e.map(r=>({sym:r,type:"truth"})),...t.map(r=>({sym:r,type:"lie"}))].forEach(({sym:r,type:h})=>{const b=pe[r];if(!b)return;const u=c(b),p=document.createElement("div");p.className=`symbol-wrap ${h}`,p.style.left=`${u.x}%`,p.style.top=`${u.y}%`,p.style.transform="translate(-50%, -50%)";const v=document.createElement("img");v.className="symbol-overlay pulse",v.src=`img/${r}.png`,v.alt=r,p.appendChild(v);const R=u.y>=88;p.classList.add(R?"label-above":"label-below");const x=document.createElement("div");x.className="map-label",x.textContent=n?fe[r]||r.toUpperCase():"",p.appendChild(x),l.appendChild(p)}),N(C.checked),o()};const I=document.createElement("div");I.id="rotatePrompt",I.className="rotate-prompt",I.textContent="Rotate device to view map",document.body.appendChild(I);function j(e){I.classList.toggle("show",!!e)}function A(){const e=document.querySelector(".map-container"),t=document.querySelector(".map-img"),n=document.getElementById("map-overlay");if(!e||!t||!n)return;const l=window.visualViewport,a=l?l.width:window.innerWidth,r=l?l.height:window.innerHeight,h=l?l.offsetLeft:0,b=l?l.offsetTop:0,u=t.naturalWidth&&t.naturalHeight?t.naturalWidth/t.naturalHeight:1920/1080;let p=a,v=p/u;v>r&&(v=r,p=v*u);const R=h+(a-p)/2,x=b+(r-v)/2;Object.assign(t.style,{width:`${p}px`,height:`${v}px`,left:`${R}px`,top:`${x}px`}),Object.assign(n.style,{width:`${p}px`,height:`${v}px`,left:`${R}px`,top:`${x}px`}),o()}async function he(){try{document.documentElement.requestFullscreen&&!document.fullscreenElement&&await document.documentElement.requestFullscreen(),screen.orientation&&screen.orientation.lock&&await screen.orientation.lock("landscape")}catch{}}async function ye(){if(!(window.innerWidth<=900))return;document.body.classList.add("map-only");const t=document.querySelector(".map-img");t?t.complete?A():t.addEventListener("load",A,{once:!0}):A(),await he(),o(),j(window.matchMedia("(orientation: portrait)").matches)}function ge(){document.body.classList.remove("map-only"),j(!1),document.fullscreenElement&&document.exitFullscreen&&document.exitFullscreen().catch(()=>{})}const O=()=>{document.body.classList.contains("map-only")&&(A(),o())};if(window.addEventListener("resize",O),window.addEventListener("orientationchange",()=>{O(),document.body.classList.contains("map-only")&&j(window.matchMedia("(orientation: portrait)").matches)}),window.visualViewport){const e=window.visualViewport;e.addEventListener("resize",O),e.addEventListener("scroll",O)}function we(e,t){k="illumination",g.classList.add("glow-phase"),f.style.display="none",S("Now select the symbols that are illuminated in-game");const n=document.getElementById("label-left"),l=document.getElementById("label-right");n&&l&&(n.textContent=e.toUpperCase(),l.textContent=t.toUpperCase(),n.className=e==="truth"?"truth-label":"lie-label",l.className=t==="truth"?"truth-label":"lie-label",s());const a=L("left"),r=L("right");B=e==="truth"?a:r,P=e==="truth"?r:a,M=[],[...B,...P].forEach(h=>{const b=[...d].find(u=>u.dataset.symbol===h);b&&M.push(b)})}function te(){if(k!=="illumination")return;const e=[...document.querySelectorAll(".dial-slot.glow")].map(l=>l.dataset.symbol),t=B.filter(l=>e.includes(l)),n=P.filter(l=>!e.includes(l));g.classList.remove("glow-phase"),k="final",S("Follow the map to interact with the marked symbols. Tap Reset to start again."),window.showMapHighlights(t,n),ye()}function oe(){document.querySelectorAll(".dial-slot").forEach(t=>{t.dataset.symbol="",t.style.backgroundImage="",t.classList.remove("glow");const n=t.querySelector(".symbol-name");n&&(n.textContent="")}),document.getElementById("label-left").textContent="",document.getElementById("label-right").textContent="",g.classList.remove("glow-phase"),f.style.display="none",k="entry",M=[],B=[],P=[],ae(),S("Enter the symbols you see in-game");const e=document.getElementById("map-overlay");e&&(e.innerHTML=""),N(C.checked),ge(),s()}window.handleLock=te,window.resetDial=oe,g.addEventListener("click",te),w.addEventListener("click",oe);function z(){if(!ce())return;const e=L("left"),t=L("right"),n=q(e),l=q(t);!e.some(h=>t.includes(h))&&(n==="truth"&&l==="lie"||n==="lie"&&l==="truth")?we(n,l):S("Both sides must be opposite types with no duplicate symbols across the dial.")}[...d].forEach(e=>{e.addEventListener("click",()=>{if(k==="final")return;const t=Array.from(e.classList),n=t.find(u=>/^left[123]$/.test(u)),l=t.find(u=>/^right[123]$/.test(u)),a=n?"left":l?"right":null,r=n?+n.replace("left","")-1:l?+l.replace("right","")-1:null;if(!a||r==null)return;if(k==="illumination"){M.includes(e)&&e.classList.toggle("glow");return}const h=!!e.dataset.symbol;let b=h?ue(a,r):Q(a,r);if(h&&b.length===0&&e.dataset.symbol&&(b=[e.dataset.symbol]),y.innerHTML="",h){const u=document.createElement("div");u.textContent="Clear",Object.assign(u.style,{width:"60px",height:"60px",display:"flex",alignItems:"center",justifyContent:"center",background:"#333",border:"1px solid #777",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"700"}),u.addEventListener("click",()=>{_(e,""),f.style.display="none",ae(),document.getElementById("label-left").textContent="",document.getElementById("label-right").textContent="",S("Enter the symbols you see in-game"),s(),z()}),y.appendChild(u)}if(b.length===0){const u=document.createElement("div");u.textContent="No valid symbols",y.appendChild(u)}else b.forEach(u=>{const p=document.createElement("img");p.src=`img/${u}.png`,p.alt=u,p.addEventListener("click",()=>{_(e,u),f.style.display="none",X(),z(),me()}),y.appendChild(p)});f.style.display="block"})}),document.addEventListener("click",e=>{!f.contains(e.target)&&![...d].includes(e.target)&&(f.style.display="none")})});
